create table e_users(
    user_id int auto_increment primary key,
    user_name varchar(100) not null,
    email varchar(100) not null unique,
    password varchar(50) not null,
    created_at TIMESTAMP default CURRENT_TIMESTAMP
);

create table products(
    product_id int auto_increment primary key,
    product_name varchar(100) not null,
    description text,
    price decimal(10,2) not null,
    stock int not null,
    created_at TIMESTAMP default CURRENT_TIMESTAMP
    
);

create table orders(
    order_id int auto_increment primary key,
    user_id int not null,
    product_id int ,
    order_date TIMESTAMP default CURRENT_TIMESTAMP,
    foreign key (user_id) references e_users(user_id)
);

insert into products(product_name,description,price,stock)
    values('Laptop','A high end laptop',9999.00,10),
    ('smartphone','Andriod phone',5999.99,20),
    ('Headphones','Noise cancellation',2999.99,15),
    ('smartphone','Andriod phone',5999.99,20),
    ('Headphones','Noise cancellation',2999.99,15);
    

insert into orders(user_id,product_id) VALUES
    (1,6),
    (3,5);


--inner join
select orders.order_id,
    e_users.user_name,
    e_users.email,
    products.product_name,
    products.price
from orders
inner join e_users on e_users.user_id=orders.user_id
inner join products on products.product_id=orders.product_id;

--Right join
select orders.order_id,
    orders.product_id,
    e_users.user_name,
    e_users.email
from orders
Right join e_users on e_users.user_id=orders.user_id;


--Left join
select orders.order_id,
    orders.product_id,
    e_users.user_name,
    e_users.email
from orders
Left join e_users on e_users.user_id=orders.user_id;

--full join
select orders.order_id,
    orders.user_id,
    orders.product_id,
    e_users.user_name,
    e_users.email
from orders
join e_users;

--Cross join
select orders.order_id,
    orders.user_id,
    orders.product_id,
    e_users.user_name,
    e_users.email
from orders
Cross join e_users;

--practice
create table employees(
    emp_id int auto_increment primary key,
    emp_name varchar(50) not null,
    dept_id int 
);


create table departments(
    dept_id int,
    dept_name varchar(50) not null
);

--inner join/left/right/full
select e.emp_name, d.dept_id
    from employees e
    Left join departments d
    on e.dept_id=d.dept_id
union
select e.emp_name, d.dept_id
    from employees e
    Right join departments d
    on e.dept_id=d.dept_id;

--cross join
select e.emp_name, d.dept_id
    from employees e
    Cross join departments d;

--self join
select e.emp_name as employee, m.emp_name as manager
from employees e
left join employees m
on e.manager_id=m.emp_id;


SELECT emp_name, dept
RANK() OVER (PARTITION BY dept ORDER BY salary DESC) AS dept_rank
FROM employees;
    
